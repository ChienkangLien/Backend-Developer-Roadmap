# Throttling
限流(Throttling) 是一種控制流量的機制，用於限制或管理系統中某些操作、服務或資源的使用率或訪問速率。它的主要目的是防止系統過度負載或過度使用，以維持系統的穩定性、可用性和效能。

## API 方面
請求速率限制
* 固定速率限制（Rate Limiting）： 限制用戶或應用程式的請求速率，例如每秒、每分鐘或每小時最多允許的請求數量。這可以透過計數器、時間窗口等方式實現。
* 漸增式限制（Exponential Backoff）： 當用戶或應用程式的請求被拒絕時，使用指數後退（指數遞增）的方式來逐漸減少請求速率，讓請求逐漸重試，減少伺服器負載。

Token Bucket 或 Leaky Bucket 算法
* Token Bucket（令牌桶）： 它根據一定的速率生成令牌，每個請求需要消耗一個令牌，當令牌用完時，請求將被拒絕或延遲處理，直到再次生成新的令牌。
* Leaky Bucket（漏桶）： 在一定的速率下從桶中不斷流出請求，當請求超過桶的容量時，請求將被拒絕或延遲處理。

基於用戶身份或角色的限制
* 基於 API 金鑰或訪問令牌的限制： 每個用戶或應用程式使用的 API 金鑰或令牌可以有自己的限制配額，以區分不同用戶的訪問。

自定義限流策略
* 根據特定條件的限流： 可以基於特定的標準，如 IP 地址、請求類型、地理位置等來進行限流，以確保公平使用和安全性。

## 服務方面
連接和連線限制
* 連接數限制： 限制客戶端與服務器建立的連線數量，確保不會因連線過多而耗盡系統資源。
* 併發請求限制： 控制同時發送給服務器的併發請求數量，以確保服務器不會因同時處理過多請求而降低效能。

請求處理速率限制
* 請求處理速率限制： 限制服務器每個時間單位（如秒、分鐘、小時）能夠處理的請求數量，防止服務器過載。
* 排隊和延遲處理： 當服務器超出處理能力時，將多餘的請求放入排隊或暫時延遲處理，以平滑負載和降低服務器壓力。

服務配額和計費模型
* 服務配額限制： 對用戶或客戶端的服務配額進行限制，確保公平使用並防止濫用。
* 計費模型： 基於使用量或服務級別，設計不同的計費模型來控制資源使用。

自適應限流策略
* 動態調整限流策略： 根據服務器負載或系統狀態，動態調整限流策略以應對不同情況。

保護特定資源或功能
* 保護特定資源或功能： 針對特定資源或功能實行特定的限流策略，保護重要或易受攻擊的部分。

## 雲端架構方面
API 管理平台
* API Gateway 的限流： 主要通過 API 管理平台或 API Gateway 來實現，這些平台提供了對 API 訪問控制的工具，可以基於請求速率、配額、金鑰等進行限流。

負載均衡和網路層面
* 負載均衡器的限流： 負載均衡器可以用於限制特定用戶或IP地址的請求數量，以確保流量均衡並保護後端服務器。
* 網路層面的限流： 雲端服務提供商通常也提供網路層面的限流服務，這可以幫助防止 DDoS 攻擊和網路過載。

容器化和微服務
* 容器和微服務的限流： 在容器化和微服務架構中，可以使用相應的工具和服務來控制容器或微服務之間的流量和訪問速率。

雲端存儲和資源
* 雲端存儲服務的限流： 例如，雲端存儲服務可能會實施每秒請求限制，以防止過度使用或濫用存儲服務。
* 資源層面的限流： 雲端提供商通常也允許用戶對資源（如虛擬機、儲存、計算資源等）實施限制，以確保公平使用。

自定義策略和自動化
* 自定義限流策略： 一些雲端提供商允許使用者根據自身需求定制限流策略，例如基於特定條件、用戶身份等的限制。
* 自動化限流機制： 通常可以透過自動化的方式來監測和調整限流策略，以應對不同的負載和需求情況。
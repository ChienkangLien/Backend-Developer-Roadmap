# Underlying Technologies
## Linux Containers（LXC）
LXC 是 Docker 的基礎，一種輕量級的虛擬化解決方案，允許在單個主機上運行多個隔離的 Linux 系統，而無需完整的虛擬機監控程序。LXC 以安全且優化的方式有效地隔離了應用程序及其依賴項。

## Control Groups (cgroups)
是 Linux 內核的一個特性，允許你在系統上的進程組中分配和管理資源，例如 CPU、內存、網絡帶寬和 I/O。

* 資源隔離：
cgroups 有助於將每個容器限制在特定的資源集上，確保系統資源在多個容器之間公平共享。隔離不同容器之間的資源，防止某個行為異常的容器耗盡所有可用資源。

* 資源限制：
利用 cgroups，你可以對容器使用的各種系統資源設置限制，如 CPU、內存和 I/O。防止單個容器消耗過多資源，造成其他容器或主機系統的性能問題。
* 容器優先級：
通過分配不同的資源份額，cgroups 允許你為某些容器設置優先級。
* 監控：
cgroups 還提供了監控單個容器資源使用的機制，有助於了解容器的性能並識別潛在的資源瓶頸。

通過利用 cgroups，Docker 提供了強大高效的container runtime 環境，確保容器具有所需的資源同時維持良好的系統性能。

## Union Filesystems
Union 檔案系統（UnionFS）是一種獨特的文件系統類型，通過將多個目錄疊加在一起，創建了一個虛擬的分層文件結構。UnionFS 不是修改原始文件系統或合併目錄，而是在單個掛載點上同時掛載多個目錄，並保持它們的內容分離。在 Docker 的情境下，這個功能特別有益，因為它可以通過最小化重複和減少容器image 大小來管理和優化存儲性能。

* 分層結構：
UnionFS 建立了一個由多個只讀層和一個頂部可寫層組成的分層結構。這種結構通過僅更新可寫層有效地處理變更，而只讀層保留原始數據。
* Copy-on-Write 寫時複製（COW）：
如果容器對現有文件進行更改，系統會在可寫層中創建文件的副本，而將原始文件保留在只讀層中不受影響。這個過程限制了對頂層的修改，確保了快速和節省資源的操作。
* 資源共享：
Union 檔案系統允許多個容器分別運行時共享共同的基礎層。這個功能防止了資源的重複使用，節省了大量的存儲空間。
* 快速容器初始化：
Union 檔案系統使得通過在現有只讀層上創建新的可寫層，可以立即創建新的容器。這種快速初始化減少了重複文件操作的開銷，最終提高了性能。

Docker 中流行的Union 檔案系統包括：

1. AUFS（Advanced Multi-Layered Unification Filesystem）：AUFS 廣泛用作 Docker 存儲驅動程序，有效管理多個層次。
2. OverlayFS（Overlay Filesystem）：OverlayFS 是另一種由 Docker 支持的Union 檔案系統。它與 AUFS 相比使用了更簡化的方法來創建和管理疊加的目錄。
3. Btrfs（B-Tree Filesystem）：Btrfs 是一種現代文件系統，除了高級存儲功能（如快照和校驗）外，還與Union 檔案系統兼容。
4. ZFS（Z File System）：ZFS 是一個高容量和強大的存儲平台，除了提供Union 檔案系統功能外，還提供數據保護、壓縮和去重等功能。

## Namespaces
Namespaces 是 Docker 用來在容器之間提供隔離的核心技術之一。

在 Linux 內核中，Namespaces 是一種功能，允許隔離各種系統資源，使得一個進程及其子進程能夠看到與其他進程分離的系統子集。Namespaces 幫助創建了一個抽象層，使得容器化的進程彼此分離以及與主機系統分離。

Linux 中有幾種類型的Namespaces，包括：
* PID (Process IDs)：隔離進程 ID 號碼空間，這意味著容器內的進程只能看到自己的進程，而不是主機上或其他容器中的進程。
* Network（NET）：為每個容器提供了網絡棧的單獨視圖，包括其自己的網絡接口、路由表和防火墻規則。
* Mount (MNT)：以這樣一種方式隔離文件系統掛載點，使得每個容器有自己的根文件系統，並且掛載的資源僅在該容器內部可見。
* UTS (UNIX Time Sharing System)：允許每個容器具有自己的主機名和域名，與其他容器和主機系統分開。
* User (USER)：在容器和主機之間映射用戶和組標識符，因此可以為容器內的資源設置不同的權限。
* IPC (Inter-Process Communication)：允許或限制不同容器中進程之間的通信。

Docker 使用Namespaces 為容器創建隔離的環境。當容器啟動時，Docker 為該容器創建一組新的Namespaces。這些Namespaces 僅適用於容器內部，因此容器內運行的任何進程都只能訪問到一部分與其他容器以及主機系統分離的系統資源。

通過利用Namespaces，Docker 確保容器真正可移植，並且可以在任何系統上運行，而不會受到同一主機上其他進程或容器的幹擾或沖突。